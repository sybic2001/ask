<div class="container">
  <div class="row">
    <div class="col-xs-12 text-center">
      <h1>Toutes les communautés présentes sur ASK !</h1>
    </div>
  </div>
  <div class="row">
    <% @communities.each do |community| %>
     <%= render 'community_card', community: community %>
    <% end %>
  </div>
  <div class="row">
    <div class="col-xs-12 text-center">
      <%= link_to new_community_path do %>
      <i class="fa fa-plus-circle" id="circle" aria-hidden="true"></i>
      <% end %>
    </div>
  </div>
</div>


<% content_for :after_js do %>
  <script>
    $(document).ready(function(){
      $('.join-community').on('click', function(e){
        var index_community = $(this).attr('id').match(/\d+/)[0];
        $.ajax({
          type: "POST",
          url: "/communities/" + index_community + "/memberships",
          success: function(data) {
            $('#join-community-' + index_community).parent().html("<i class='fa fa-check-circle pending-approval' aria-hidden='true'></i>");
          }
        });
      });
    });
  </script>
<% end %>
